---
import BaseHead from './BaseHead.astro';
import KitHero from '../components/KitHero.astro';
import CallToAction from '../components/CallToAction.astro';
import { NavBar } from '../components/NavBar.tsx';
import { TableOfContents } from '../components/TableOfContents.tsx';
import MobileNavigation from '../components/MobileNavigation.tsx';
import KitDemoHero from '../components/KitDemoHero.astro'
import Footer from '../components/Footer.astro';
import { parseKit } from '../lib/parseKits';
const { content } = Astro.props;
const path = Astro.site.pathname;
const headers = content?.astro?.headers;
const kit = parseKit(content);
---

<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{kit.name} - {kit.description}</title>
    <meta name="description" content={kit.description} />
    <BaseHead />
  </head>
  <body class="bg dark:dark-bg min-h-screen text-base">
    <NavBar currentPath={path} client:load />
    <div class="toggleDiv">
      <KitHero {...kit} />
    </div>
    <CallToAction {...kit} />
    <main>
      <MobileNavigation {headers} client:load />
      <div class="toggleDiv grid grid-cols-12 gap-x-8 max-w-screen-2xl mx-auto">
        <aside class="hidden lg:block col-span-3">
          <div
            class="pt-8 sticky top-32 border-r border-gray-400 dark:border-gray-700 min-h-[calc(100vh-120px)] overflow-y-auto"
          >
            <TableOfContents {headers} client:load />
          </div>
        </aside>
        <article
          class="col-span-12 lg:col-span-7 p-4 my-10 max-w-screen-2xl lg:mx-auto prose prose-p:t dark:prose-p:dark-t prose-li:t dark:prose-li:dark-t prose-a:link prose-headings:t-dark dark:prose-headings:dark-t-light prose prose-h1:font-medium prose-h1:border-b prose-h1:pb-4 prose-h1:border-gray-200 dark:prose-strong:dark-t dark:prose-h1:border-gray-800 prose-h1:text-3xl prose-h2:heading-3 prose-h2:font-semibold prose-h2:mt-12 prose-h3:heading-4 prose-pre:dark-bg prose-pre:text-white dark:prose-pre:bg-gray-800 dark:prose-code:text-white"
        >
          <slot />
          <KitDemoHero name=${kit.name} />
        </article>
        <aside class="hidden lg:block col-span-2">
        </aside>
      </div>
    </main>
    <footer>
      <Footer />
    </footer>

    <script>
      let CTA = document.getElementById('callToAction');
      document.addEventListener('scroll', () => {
        if (window.scrollY >= 278) {
          CTA.classList.remove('lg:invisible');
        } else {
          CTA.classList.add('lg:invisible');
        }
      });
    </script>
  </body>
</html>
